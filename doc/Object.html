<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Object - RDoc Documentation</title>

<link href="./fonts.css" rel="stylesheet">
<link href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/navigation.js"></script>
<script src="./js/search_index.js"></script>
<script src="./js/search.js"></script>
<script src="./js/searcher.js"></script>
<script src="./js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">BasicObject
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-addalias">#addalias</a>
    
    <li ><a href="#method-i-addcmd">#addcmd</a>
    
    <li ><a href="#method-i-addhelp">#addhelp</a>
    
    <li ><a href="#method-i-addreact">#addreact</a>
    
    <li ><a href="#method-i-addrt_r">#addrt_r</a>
    
    <li ><a href="#method-i-addsocial">#addsocial</a>
    
    <li ><a href="#method-i-aliases">#aliases</a>
    
    <li ><a href="#method-i-b_load">#b_load</a>
    
    <li ><a href="#method-i-b_save">#b_save</a>
    
    <li ><a href="#method-i-b_set">#b_set</a>
    
    <li ><a href="#method-i-b_show">#b_show</a>
    
    <li ><a href="#method-i-bt">#bt</a>
    
    <li ><a href="#method-i-bt_hit">#bt_hit</a>
    
    <li ><a href="#method-i-bt_load">#bt_load</a>
    
    <li ><a href="#method-i-bt_save">#bt_save</a>
    
    <li ><a href="#method-i-comcb">#comcb</a>
    
    <li ><a href="#method-i-dcritical">#dcritical</a>
    
    <li ><a href="#method-i-debug_msg">#debug_msg</a>
    
    <li ><a href="#method-i-dfatal">#dfatal</a>
    
    <li ><a href="#method-i-dinfo">#dinfo</a>
    
    <li ><a href="#method-i-dwarning">#dwarning</a>
    
    <li ><a href="#method-i-getmsg">#getmsg</a>
    
    <li ><a href="#method-i-gt">#gt</a>
    
    <li ><a href="#method-i-is_valid_chan">#is_valid_chan</a>
    
    <li ><a href="#method-i-loadfile">#loadfile</a>
    
    <li ><a href="#method-i-msg">#msg</a>
    
    <li ><a href="#method-i-newplayer">#newplayer</a>
    
    <li ><a href="#method-i-notice">#notice</a>
    
    <li ><a href="#method-i-onload">#onload</a>
    
    <li ><a href="#method-i-papiinit">#papiinit</a>
    
    <li ><a href="#method-i-r_load">#r_load</a>
    
    <li ><a href="#method-i-r_save">#r_save</a>
    
    <li ><a href="#method-i-r_sort">#r_sort</a>
    
    <li ><a href="#method-i-register_plugin">#register_plugin</a>
    
    <li ><a href="#method-i-roulette">#roulette</a>
    
    <li ><a href="#method-i-stat_u">#stat_u</a>
    
    <li ><a href="#method-i-weechat_init">#weechat_init</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Object">
  <h1 id="class-Object" class="class">
    class Object
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-addalias" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addalias</span><span
            class="method-args">(name,cmd)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds alias</p>

<p>@param name [String] Alias name @param cmd [String] Cmd name</p>
          
          

          
          <div class="method-source-code" id="addalias-source">
            <pre><span class="ruby-comment"># File api.rb, line 348</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addalias</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">cmd</span>)
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">cmd</span>]
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">alias</span> = <span class="ruby-identifier">cmd</span>
        <span class="ruby-identifier">$cmds</span>.<span class="ruby-identifier">rehash</span>
        <span class="ruby-identifier">$cmdt</span>[<span class="ruby-identifier">name</span>] = {}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-addcmd" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addcmd</span><span
            class="method-args">(name,perm,cmd,timeout)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds command</p>

<p>@param name [String] Command name @param perm [Integer] Required permlvl
@param cmd [Proc] Process to execute @param timeout [Fixnum] Timeout in
seconds between usage</p>
          
          

          
          <div class="method-source-code" id="addcmd-source">
            <pre><span class="ruby-comment"># File api.rb, line 336</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addcmd</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">perm</span>,<span class="ruby-identifier">cmd</span>,<span class="ruby-identifier">timeout</span>)
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-constant">BotCommand</span>.<span class="ruby-identifier">new</span>()
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">set</span>(<span class="ruby-identifier">cmd</span>,<span class="ruby-identifier">perm</span>,<span class="ruby-identifier">name</span>,<span class="ruby-identifier">timeout</span>)
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">alias</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-identifier">$cmds</span>.<span class="ruby-identifier">rehash</span>
        <span class="ruby-identifier">$cmdt</span>[<span class="ruby-identifier">name</span>] = {}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-addhelp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addhelp</span><span
            class="method-args">(name,brief,help)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds help page</p>

<p>@param name [String] Page name @param brief [String] Brief @param help
[Array&lt;String&gt;] Desc</p>
          
          

          
          <div class="method-source-code" id="addhelp-source">
            <pre><span class="ruby-comment"># File api.rb, line 377</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addhelp</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">brief</span>,<span class="ruby-identifier">help</span>)
        <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">name</span>] =  <span class="ruby-constant">HelpPage</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">brief</span>,<span class="ruby-identifier">help</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-addreact" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addreact</span><span
            class="method-args">(regexps,func)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds Reaction</p>

<p>@param regexps [Array&lt;Regexp&gt;] Regexps to match @param func [Proc]
Process to execute @deprecated Will be refactored to 2.1</p>
          
          

          
          <div class="method-source-code" id="addreact-source">
            <pre><span class="ruby-comment"># File api.rb, line 324</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addreact</span>(<span class="ruby-identifier">regexps</span>,<span class="ruby-identifier">func</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">r</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">regexps</span>
                <span class="ruby-identifier">$rtab</span>[<span class="ruby-identifier">r</span>] = <span class="ruby-identifier">func</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-addrt_r" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addrt_r</span><span
            class="method-args">(timer)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="addrt_r-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addrt_r</span>(<span class="ruby-identifier">timer</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">$timers</span>[<span class="ruby-identifier">timer</span>.<span class="ruby-identifier">name</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">$timers</span>[<span class="ruby-identifier">timer</span>.<span class="ruby-identifier">name</span>].<span class="ruby-identifier">cmd</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">cmd</span>)
                <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">timeleft</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">$timers</span>[<span class="ruby-identifier">timer</span>.<span class="ruby-identifier">name</span>].<span class="ruby-identifier">timeleft</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">$timers</span>[<span class="ruby-identifier">timer</span>.<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">timer</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-addsocial" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">addsocial</span><span
            class="method-args">(name,parser)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="addsocial-source">
            <pre><span class="ruby-comment"># File plugins/social.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">addsocial</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">parser</span>)
        <span class="ruby-identifier">sc</span> = <span class="ruby-constant">SocialCommand</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">parser</span>)
        <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">sc</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-aliases" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">aliases</span><span
            class="method-args">(cmd)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Aliases for command</p>

<p>@param cmd [String] Command name @return [Array&lt;String&gt;] Aliases for
this command</p>
          
          

          
          <div class="method-source-code" id="aliases-source">
            <pre><span class="ruby-comment"># File api.rb, line 385</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">aliases</span>(<span class="ruby-identifier">cmd</span>)
        <span class="ruby-identifier">a</span> = []
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$cmds</span>.<span class="ruby-identifier">keys</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">alias</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cmd</span>
                        <span class="ruby-identifier">a</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">k</span>)
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-b_load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">b_load</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Loads bandit&#39;s records</p>
          
          

          
          <div class="method-source-code" id="b_load-source">
            <pre><span class="ruby-comment"># File api.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">b_load</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/bandit.cfg&quot;</span>, <span class="ruby-string">&quot;r&quot;</span>)
        <span class="ruby-keyword">while</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">eof?</span>
                        <span class="ruby-identifier">s</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
                                <span class="ruby-keyword">next</span>
                        <span class="ruby-keyword">end</span>
                        <span class="ruby-identifier">$bandits</span>[<span class="ruby-identifier">s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>] = <span class="ruby-identifier">s</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-b_save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">b_save</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Saves bandit&#39;s records</p>
          
          

          
          <div class="method-source-code" id="b_save-source">
            <pre><span class="ruby-comment"># File api.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">b_save</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/bandit.cfg&quot;</span>, <span class="ruby-string">&quot;w&quot;</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$bandits</span>.<span class="ruby-identifier">keys</span>() 
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$bandits</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span>) 
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-b_set" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">b_set</span><span
            class="method-args">(num, name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets bandit&#39;s record and automatically saves it</p>

<p>@param num [Integer] Number 0-9 (000-999) @param name [String] Player&#39;s
name @note This uses #{b_save}</p>
          
          

          
          <div class="method-source-code" id="b_set-source">
            <pre><span class="ruby-comment"># File api.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">b_set</span>(<span class="ruby-identifier">num</span>, <span class="ruby-identifier">name</span>)
        <span class="ruby-identifier">$bandits</span>[<span class="ruby-identifier">num</span>] = <span class="ruby-identifier">name</span>
        <span class="ruby-identifier">b_save</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-b_show" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">b_show</span><span
            class="method-args">(chan)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Shows bandit&#39;s records</p>

<p>@param chan [String] Target (channel or user&#39;s nick)</p>
          
          

          
          <div class="method-source-code" id="b_show-source">
            <pre><span class="ruby-comment"># File api.rb, line 123</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">b_show</span>(<span class="ruby-identifier">chan</span>)
        <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Bandits:&quot;</span>,<span class="ruby-identifier">chan</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$bandits</span>.<span class="ruby-identifier">keys</span>()
                <span class="ruby-identifier">msg</span>((<span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>)<span class="ruby-operator">*</span><span class="ruby-value">3</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$bandits</span>[<span class="ruby-identifier">k</span>],<span class="ruby-identifier">chan</span>)
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bt</span><span
            class="method-args">(u1,u2,c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="bt-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bt</span>(<span class="ruby-identifier">u1</span>,<span class="ruby-identifier">u2</span>,<span class="ruby-identifier">c</span>)
        <span class="ruby-identifier">newplayer</span>(<span class="ruby-identifier">u1</span>)
        <span class="ruby-identifier">newplayer</span>(<span class="ruby-identifier">u2</span>)
        <span class="ruby-identifier">$list</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">$server</span>,<span class="ruby-identifier">c</span>)
        <span class="ruby-identifier">h1</span> = <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u1</span>].<span class="ruby-identifier">hp</span>.<span class="ruby-identifier">clone</span>
        <span class="ruby-identifier">h2</span> = <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u2</span>].<span class="ruby-identifier">hp</span>.<span class="ruby-identifier">clone</span>
        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}5,0#{gt(u1).shi+$c} will fight with #{$c}5,0#{gt(u5).shi+$c}&quot;</span>,<span class="ruby-identifier">c</span>)
        <span class="ruby-keyword">while</span> <span class="ruby-identifier">h1</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">h2</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">f</span> = (<span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-value">2</span><span class="ruby-operator">*</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">lvl</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">atk</span>)<span class="ruby-operator">/</span>(<span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u2</span>).<span class="ruby-identifier">lvl</span><span class="ruby-operator">+</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u2</span>).<span class="ruby-identifier">arm</span>)<span class="ruby-operator">*</span><span class="ruby-value">2</span>).<span class="ruby-identifier">ceil</span>
                <span class="ruby-identifier">h2</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">f</span>
                <span class="ruby-identifier">bt_hit</span>(<span class="ruby-identifier">u1</span>,<span class="ruby-identifier">u2</span>,<span class="ruby-identifier">f</span>)
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">h2</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>
                        <span class="ruby-keyword">break</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">f</span> = (<span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-value">2</span><span class="ruby-operator">*</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u2</span>).<span class="ruby-identifier">lvl</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u2</span>).<span class="ruby-identifier">atk</span>)<span class="ruby-operator">/</span>(<span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">lvl</span><span class="ruby-operator">+</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">arm</span>)<span class="ruby-operator">*</span><span class="ruby-value">2</span>).<span class="ruby-identifier">ceil</span>
                <span class="ruby-identifier">h1</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">f</span>
                <span class="ruby-identifier">bt_hit</span>(<span class="ruby-identifier">u2</span>,<span class="ruby-identifier">u1</span>,<span class="ruby-identifier">f</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">h1</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">c_f</span> = (<span class="ruby-value">1.5</span><span class="ruby-operator">*</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">lvl</span>).<span class="ruby-identifier">ceil</span>
                <span class="ruby-identifier">c_e</span> = (<span class="ruby-value">1.5</span><span class="ruby-operator">*</span>((<span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">lvl</span><span class="ruby-operator">-</span><span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u2</span>).<span class="ruby-identifier">lvl</span>).<span class="ruby-identifier">abs</span>)<span class="ruby-operator">+</span><span class="ruby-value">1</span>).<span class="ruby-identifier">ceil</span>
                <span class="ruby-identifier">c_l</span> =(<span class="ruby-identifier">e</span><span class="ruby-operator">/</span><span class="ruby-value">10</span>).<span class="ruby-identifier">floor</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u1</span>).<span class="ruby-identifier">lvl</span> <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u1</span>].<span class="ruby-identifier">fus</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">c_f</span>
                <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u1</span>].<span class="ruby-identifier">exp</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">c_e</span>
                <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u1</span>].<span class="ruby-identifier">lvl</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">c_l</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">h2</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
                
        <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Draw!&quot;</span>,<span class="ruby-identifier">c</span>)
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bt_hit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bt_hit</span><span
            class="method-args">(u1,u2,force)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="bt_hit-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bt_hit</span>(<span class="ruby-identifier">u1</span>,<span class="ruby-identifier">u2</span>,<span class="ruby-identifier">force</span>)
        <span class="ruby-identifier">notice</span>(<span class="ruby-node">&quot;You hit #{u2} and applied #{force} damage&quot;</span>,<span class="ruby-identifier">u1</span>)
        <span class="ruby-identifier">notice</span>(<span class="ruby-node">&quot;You&#39;ve been hit by #{u1} and taken #{force} damage&quot;</span>, <span class="ruby-identifier">u2</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bt_load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bt_load</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="bt_load-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bt_load</span>
        <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/battle.cfg&quot;</span>)
                <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/battle.cfg&quot;</span>)
                <span class="ruby-identifier">ln</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">l</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">ln</span>
                        <span class="ruby-identifier">bp</span> = <span class="ruby-constant">BattlePlayer</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">l</span>)
                        <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">bp</span>.<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">bp</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bt_save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bt_save</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="bt_save-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bt_save</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/battle.cfg&quot;</span>,<span class="ruby-string">&quot;w&quot;</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$battle</span>.<span class="ruby-identifier">keys</span>
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-comcb" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">comcb</span><span
            class="method-args">(event)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="comcb-source">
            <pre><span class="ruby-comment"># File core.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">comcb</span>(<span class="ruby-identifier">event</span>)
        <span class="ruby-identifier">ea</span> = <span class="ruby-identifier">event</span>.<span class="ruby-identifier">message</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot; &quot;</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">event</span>.<span class="ruby-identifier">from</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$userdata</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">then</span>
                <span class="ruby-keyword">return</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">event</span>.<span class="ruby-identifier">message</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/^!.*$/</span>) <span class="ruby-keyword">then</span>
                <span class="ruby-keyword">return</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">event</span>.<span class="ruby-identifier">channel</span> <span class="ruby-keyword">then</span> 
                <span class="ruby-identifier">event</span>.<span class="ruby-identifier">channel</span> = <span class="ruby-identifier">event</span>.<span class="ruby-identifier">from</span> 
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">ea</span>[<span class="ruby-value">0</span>]] <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
                <span class="ruby-identifier">$cmds</span>[<span class="ruby-identifier">ea</span>[<span class="ruby-value">0</span>]].<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">ea</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>],<span class="ruby-identifier">event</span>.<span class="ruby-identifier">from</span>,<span class="ruby-identifier">event</span>.<span class="ruby-identifier">channel</span>)
        <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;No such command : #{ea[0]}, please type !help to list commands&quot;</span>,<span class="ruby-identifier">event</span>.<span class="ruby-identifier">from</span>)
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dcritical" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dcritical</span><span
            class="method-args">(msg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>An alias for {#debug_msg}(2,msg). Pushes message with level 2 (CRITICAL)</p>

<p>@param msg [String] Message</p>
          
          

          
          <div class="method-source-code" id="dcritical-source">
            <pre><span class="ruby-comment"># File api.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dcritical</span>(<span class="ruby-identifier">msg</span>)
        <span class="ruby-identifier">debug_msg</span>(<span class="ruby-value">2</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-debug_msg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">debug_msg</span><span
            class="method-args">(level,message)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Pushes the debug message in a stack</p>

<p>@param level [Integer] Level @param message [String] Message</p>
          
          

          
          <div class="method-source-code" id="debug_msg-source">
            <pre><span class="ruby-comment"># File api.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">debug_msg</span>(<span class="ruby-identifier">level</span>,<span class="ruby-identifier">message</span>)
        <span class="ruby-identifier">$debug</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">DebugMsg</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">message</span>,<span class="ruby-identifier">level</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dfatal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dfatal</span><span
            class="method-args">(msg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>An alias for {#debug_msg}(3,msg). Pushes message with level 3 (FATAL)</p>

<p>@param msg [String] Message</p>
          
          

          
          <div class="method-source-code" id="dfatal-source">
            <pre><span class="ruby-comment"># File api.rb, line 61</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dfatal</span>(<span class="ruby-identifier">msg</span>)
        <span class="ruby-identifier">debug_msg</span>(<span class="ruby-value">3</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dinfo" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dinfo</span><span
            class="method-args">(msg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>An alias for {#debug_msg}(0,msg). Pushes message with level 0 (INFO)</p>

<p>@param msg [String] Message</p>
          
          

          
          <div class="method-source-code" id="dinfo-source">
            <pre><span class="ruby-comment"># File api.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dinfo</span>(<span class="ruby-identifier">msg</span>)
        <span class="ruby-identifier">debug_msg</span>(<span class="ruby-value">0</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dwarning" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dwarning</span><span
            class="method-args">(msg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>An alias for {#debug_msg}(1,msg). Pushes message with level 1 (WARNING)</p>

<p>@param msg [String] Message</p>
          
          

          
          <div class="method-source-code" id="dwarning-source">
            <pre><span class="ruby-comment"># File api.rb, line 75</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dwarning</span>(<span class="ruby-identifier">msg</span>)
        <span class="ruby-identifier">debug_msg</span>(<span class="ruby-value">1</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-getmsg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getmsg</span><span
            class="method-args">(m)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets random message from $msgs</p>

<p>@param m [String] Type of message to get @return [String] Message</p>
          
          

          
          <div class="method-source-code" id="getmsg-source">
            <pre><span class="ruby-comment"># File api.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getmsg</span>(<span class="ruby-identifier">m</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">$msgs</span>[<span class="ruby-identifier">m</span>][<span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-identifier">$msgs</span>[<span class="ruby-identifier">m</span>].<span class="ruby-identifier">size</span>)]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-gt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">gt</span><span
            class="method-args">(u)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="gt-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">gt</span>(<span class="ruby-identifier">u</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">u</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-is_valid_chan" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">is_valid_chan</span><span
            class="method-args">(chan)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Must we work on this channel?</p>

<p>@param chan [String] Channel @return [Boolean] true or false @api private</p>
          
          

          
          <div class="method-source-code" id="is_valid_chan-source">
            <pre><span class="ruby-comment"># File api.rb, line 360</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_valid_chan</span>(<span class="ruby-identifier">chan</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">c</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$channels</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">chan</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">c</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">chan</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$userdata</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">$use_privmsgs</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">then</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-loadfile" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">loadfile</span><span
            class="method-args">(file)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Plugin API for Bot13 v1.6 Beta How to install :</p>

<pre>On Linux, put papi.rb into ~/.bot13/ directory
On Windows, put it into %APPDATA%/.bot13</pre>
          
          

          
          <div class="method-source-code" id="loadfile-source">
            <pre><span class="ruby-comment"># File papi.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">loadfile</span>(<span class="ruby-identifier">file</span>)
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>)
        <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>))
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-msg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">msg</span><span
            class="method-args">(msg,chan=$channels[0])</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sends a message on a channel</p>

<p>@param msg [String] Message @param chan [String] Channel</p>
          
          

          
          <div class="method-source-code" id="msg-source">
            <pre><span class="ruby-comment"># File api.rb, line 247</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">msg</span>,<span class="ruby-identifier">chan</span>=<span class="ruby-identifier">$channels</span>[<span class="ruby-value">0</span>])
        <span class="ruby-identifier">$conn</span>.<span class="ruby-identifier">send_message</span>(<span class="ruby-identifier">chan</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-newplayer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">newplayer</span><span
            class="method-args">(usr)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="newplayer-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 101</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">newplayer</span>(<span class="ruby-identifier">usr</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">usr</span>]
                <span class="ruby-identifier">$battle</span>[<span class="ruby-identifier">usr</span>] = <span class="ruby-constant">BattlePlayer</span>.<span class="ruby-identifier">create</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-notice" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">notice</span><span
            class="method-args">(msg,usr)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sends a notice to a target</p>

<p>@param msg [String] Message @param usr [String] Target</p>
          
          

          
          <div class="method-source-code" id="notice-source">
            <pre><span class="ruby-comment"># File api.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">notice</span>(<span class="ruby-identifier">msg</span>,<span class="ruby-identifier">usr</span>)
        <span class="ruby-identifier">$conn</span>.<span class="ruby-identifier">send_notice</span>(<span class="ruby-identifier">usr</span>,<span class="ruby-identifier">msg</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-onload" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">onload</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="onload-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">onload</span>
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!roulette&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;top&quot;</span>
                        <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">r_sort</span>
                        <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
                        <span class="ruby-keyword">while</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">5</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">size</span>
                                <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">i</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;:&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">arr</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">arr</span>[<span class="ruby-identifier">i</span>]].<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">c</span>)
                                <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
                        <span class="ruby-keyword">end</span>
                        
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;stat&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;стат&quot;</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>]
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{u} заработал #{$rscore[u].to_s} тугриков&quot;</span>, <span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">else</span>
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Я не знаю тебя, #{u}&quot;</span>,<span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]]
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{a[1]} заработал #{$rscore[a[1]].to_s} тугриков&quot;</span>, <span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">else</span>
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Я не знаю #{a[1]}&quot;</span>,<span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>]
                                <span class="ruby-identifier">roulette</span>(<span class="ruby-identifier">u</span>)
                        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>
                                <span class="ruby-constant">Weechat</span>.<span class="ruby-identifier">command</span>(<span class="ruby-string">&quot;&quot;</span>,<span class="ruby-node">&quot;/notice #{u} Ты уже мертв, #{u}!&quot;</span>)
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">30</span>)
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!rset&quot;</span>,<span class="ruby-value">4</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
                        <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]] = <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;RSet:Usage: !rset [nick] [amount]&quot;</span>, <span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">1</span>)
                
                
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!buy&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Buy :  У вас нет счета в рулетке&quot;</span>,<span class="ruby-identifier">u</span>)
                        <span class="ruby-keyword">return</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$prices</span>[<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]] <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span> 
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$prices</span>[<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]] <span class="ruby-operator">*</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]) <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>]
                                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;voice&quot;</span>
                                                <span class="ruby-constant">Weechat</span>.<span class="ruby-identifier">command</span>(<span class="ruby-identifier">$buf_pntr</span>, <span class="ruby-node">&quot;/mode +v #{u}&quot;</span>)
                                                <span class="ruby-identifier">addrt_r</span>(<span class="ruby-constant">Timer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;/mode -v #{u}&quot;</span>,<span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]),<span class="ruby-identifier">u</span>))
                                        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;halfop&quot;</span>
                                                <span class="ruby-constant">Weechat</span>.<span class="ruby-identifier">command</span>(<span class="ruby-identifier">$buf_pntr</span>, <span class="ruby-node">&quot;/mode +h #{u}&quot;</span>)
                                                <span class="ruby-identifier">addrt_r</span>(<span class="ruby-constant">Timer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;/mode -h #{u}&quot;</span>,<span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]),<span class="ruby-identifier">u</span>))
                                        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;perm&quot;</span>
                                                <span class="ruby-constant">Permissions</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">u</span>,<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]))
                                        <span class="ruby-keyword">end</span>
                                        <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">u</span>] <span class="ruby-operator">-=</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>])<span class="ruby-operator">*</span><span class="ruby-identifier">$prices</span>[<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]]
                                <span class="ruby-keyword">else</span>
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Buy : Недостаточно денег, #{u}!&quot;</span>,<span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Buy:Usage: !buy (voice|halfop) &lt;time&gt;&quot;</span>,<span class="ruby-identifier">c</span>)
                                <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Buy:Usage: !buy perm &lt;lvl&gt;&quot;</span>,<span class="ruby-identifier">c</span>)
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Buy:Usage: !buy (voice|halfop|perm) time&quot;</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">1</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/roulette.cfg&quot;</span>)
                <span class="ruby-identifier">r_save</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!рулетка&quot;</span>, <span class="ruby-string">&quot;Русская Рулетка&quot;</span>,
        [<span class="ruby-string">&quot;Usage : !roulette [(стат|stat) [user]]&quot;</span>])
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!рулетка&quot;</span>, <span class="ruby-string">&quot;!roulette&quot;</span>)
        <span class="ruby-identifier">r_load</span>
        <span class="ruby-identifier">register_plugin</span>(<span class="ruby-string">&quot;GameZZ&quot;</span>,<span class="ruby-string">&quot;1.1&quot;</span>,<span class="ruby-string">&quot;unn4m3d&quot;</span>,<span class="ruby-constant">LOCALE</span><span class="ruby-operator">::</span><span class="ruby-constant">RUS</span>,<span class="ruby-string">&quot;Games for Bot13&quot;</span>,<span class="ruby-string">&quot;GNU GPLv3&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-papiinit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">papiinit</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="papiinit-source">
            <pre><span class="ruby-comment"># File papi.rb, line 14</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">papiinit</span>
        <span class="ruby-identifier">plugins</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/plugins&quot;</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">p</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">plugins</span>
                <span class="ruby-identifier">p</span> = <span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/plugins/&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">p</span>
                <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">p</span>)
                        <span class="ruby-keyword">next</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">loadfile</span>(<span class="ruby-identifier">p</span>)
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-r_load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">r_load</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="r_load-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">r_load</span>()
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/roulette.cfg&quot;</span>)
        <span class="ruby-keyword">while</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">eof?</span>
                <span class="ruby-identifier">s</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot; &quot;</span>)
                <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">s</span>[<span class="ruby-value">0</span>]] = <span class="ruby-identifier">s</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-r_save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">r_save</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="r_save-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">r_save</span>()
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/roulette.cfg&quot;</span>,<span class="ruby-string">&quot;w&quot;</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$rscore</span>.<span class="ruby-identifier">keys</span>()
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">k</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-r_sort" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">r_sort</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="r_sort-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">r_sort</span>()
        <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">$rscore</span>.<span class="ruby-identifier">keys</span>
        <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">j</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">while</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> 
                <span class="ruby-keyword">while</span> <span class="ruby-identifier">j</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span>]] <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]] 
                                <span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span>],<span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>],<span class="ruby-identifier">arr</span>[<span class="ruby-identifier">j</span>]
                        <span class="ruby-keyword">end</span>
                        <span class="ruby-identifier">j</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">arr</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-register_plugin" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">register_plugin</span><span
            class="method-args">(n,v,a,l,d,li)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@see {BotPlugin.initialize}</p>
          
          

          
          <div class="method-source-code" id="register_plugin-source">
            <pre><span class="ruby-comment"># File api.rb, line 449</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">register_plugin</span>(<span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">l</span>,<span class="ruby-identifier">d</span>,<span class="ruby-identifier">li</span>)
        <span class="ruby-identifier">$plugins</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">BotPlugin</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">l</span>,<span class="ruby-identifier">d</span>,<span class="ruby-identifier">li</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-roulette" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">roulette</span><span
            class="method-args">(user)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="roulette-source">
            <pre><span class="ruby-comment"># File plugins/games.rb, line 15</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">roulette</span>(<span class="ruby-identifier">user</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">6</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;БАХ! Ты прострелил себе висок, #{user}! R.I.P&quot;</span>, <span class="ruby-identifier">$channel</span>)
                <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">user</span>] = <span class="ruby-value">0</span>
        <span class="ruby-keyword">else</span>
                <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">user</span>]
                        <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">user</span>] = <span class="ruby-value">1</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">sc</span> = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">user</span>] <span class="ruby-operator">+</span> <span class="ruby-value">10</span>)
                <span class="ruby-identifier">$rscore</span>[<span class="ruby-identifier">user</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">sc</span>
                <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Осечка, #{user}! Ты жив! Ты заработал #{sc} тугриков&quot;</span>, <span class="ruby-identifier">$channel</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">r_save</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stat_u" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stat_u</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="stat_u-source">
            <pre><span class="ruby-comment"># File plugins/stat.rb, line 11</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stat_u</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$uses</span>[<span class="ruby-string">&quot;bandit&quot;</span>]
                <span class="ruby-identifier">s</span> = <span class="ruby-string">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;Number&lt;/td&gt;&lt;td&gt;Winner&lt;/td&gt;&lt;/tr&gt;&lt;br&gt;\n&quot;</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$bandits</span>.<span class="ruby-identifier">keys</span>
                        <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;&lt;tr&gt;&lt;td&gt;#{k.to_s*3}&lt;/td&gt;&lt;td&gt;#{$bandits[k]}&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;&lt;/table&gt;&quot;</span>
                <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$stat_root</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/bandit.php&quot;</span>,<span class="ruby-string">&quot;w&quot;</span>)
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">s</span>)
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
        <span class="ruby-keyword">end</span>
        
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$uses</span>[<span class="ruby-string">&quot;roulette&quot;</span>]
                <span class="ruby-identifier">s</span> = <span class="ruby-string">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;Player&lt;/td&gt;&lt;td&gt;Score&lt;/td&gt;&lt;/tr&gt;&lt;br&gt;\n&quot;</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$rscore</span>.<span class="ruby-identifier">keys</span>
                        <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;&lt;tr&gt;&lt;td&gt;#{k}&lt;/td&gt;&lt;td&gt;#{$rscore[k].to_s}&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;&lt;/table&gt;&quot;</span>
                <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$stat_root</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/rr.php&quot;</span>,<span class="ruby-string">&quot;w&quot;</span>)
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">s</span>)
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
        <span class="ruby-keyword">end</span>
        
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-weechat_init" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">weechat_init</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="weechat_init-source">
            <pre><span class="ruby-comment"># File core.rb, line 125</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">weechat_init</span>
        <span class="ruby-identifier">$conn</span> = <span class="ruby-constant">IRC</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$userdata</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">$server</span>,<span class="ruby-identifier">$port</span>.<span class="ruby-identifier">to_s</span>,<span class="ruby-identifier">$userdata</span>[<span class="ruby-value">1</span>])
        <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Connecting to #{$server}:#{$port.to_s} (#{$userdata[0]}!#{$userdata[1]})&quot;</span>
        <span class="ruby-constant">IRCEvent</span>.<span class="ruby-identifier">add_callback</span>(<span class="ruby-string">&#39;privmsg&#39;</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">is_valid_chan</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">channel</span>)
                        <span class="ruby-identifier">comcb</span>(<span class="ruby-identifier">e</span>)
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Message from #{e.from} : \&quot;#{e.message}\&quot;&quot;</span>
        }
        <span class="ruby-constant">IRCEvent</span>.<span class="ruby-identifier">add_callback</span>(<span class="ruby-string">&#39;join&#39;</span>){
                <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">is_valid_chan</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">channel</span>)
                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&#39;join&#39;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/`U`/</span>,<span class="ruby-identifier">e</span>.<span class="ruby-identifier">from</span>),<span class="ruby-identifier">e</span>.<span class="ruby-identifier">channel</span>)
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{e.from} has joined #{e.channel}&quot;</span>
        }
        <span class="ruby-constant">IRCEvent</span>.<span class="ruby-identifier">add_callback</span>(<span class="ruby-string">&#39;quit&#39;</span>){
                <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">is_valid_chan</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">channel</span>)
                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&#39;leave&#39;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/`U`/</span>,<span class="ruby-identifier">e</span>.<span class="ruby-identifier">from</span>),<span class="ruby-identifier">e</span>.<span class="ruby-identifier">channel</span>)
                <span class="ruby-keyword">end</span>
        }
        <span class="ruby-constant">IRCEvent</span>.<span class="ruby-identifier">add_callback</span>(<span class="ruby-string">&#39;endofmotd&#39;</span>){
                <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">c</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$channels</span>
                        <span class="ruby-identifier">$conn</span>.<span class="ruby-identifier">add_channel</span>(<span class="ruby-identifier">c</span>)
                        <span class="ruby-identifier">$conn</span>.<span class="ruby-identifier">send_action</span>(<span class="ruby-identifier">c</span>,<span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&quot;lvlup&quot;</span>))
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Hello\n&quot;</span>
        }
        <span class="ruby-constant">IRCEvent</span>.<span class="ruby-identifier">add_callback</span>(<span class="ruby-string">&#39;353&#39;</span>){ <span class="ruby-comment">#NAMES Reply</span>
                <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">$udata</span> = <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>
        }
        <span class="ruby-comment">#$conn.start</span>
        
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!debug&quot;</span>,<span class="ruby-value">5</span>,<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">ll</span> = <span class="ruby-value">0</span>
                <span class="ruby-identifier">hl</span> = <span class="ruby-value">128</span>
                <span class="ruby-identifier">c</span> = <span class="ruby-value">10</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
                        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">ll</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">hl</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
                        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">ll</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">hl</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>       
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">4</span>
                        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">ll</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">hl</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>
                        <span class="ruby-identifier">u</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">3</span>]
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> [(<span class="ruby-identifier">$debug</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-identifier">c</span>)<span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$debug</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">level</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">ll</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">$debug</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">level</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">hl</span>
                                <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">$debug</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">msg</span>,<span class="ruby-identifier">u</span>)
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">end</span>
                
        },<span class="ruby-value">1</span>)
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!bot13&quot;</span>,<span class="ruby-value">0</span>,<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;Bot-Th1rt3en v&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$version</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; by &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$author</span>, <span class="ruby-identifier">c</span>)
        },<span class="ruby-value">10</span>)
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!bot13&quot;</span>,<span class="ruby-string">&quot;Displays bot info&quot;</span>,[])
        <span class="ruby-identifier">$cmds</span>.<span class="ruby-identifier">rehash</span>()
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!cmds&quot;</span>,<span class="ruby-value">0</span>,<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$cmds</span>.<span class="ruby-identifier">keys</span>()
                        <span class="ruby-identifier">s</span> = <span class="ruby-identifier">k</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">k</span>]
                                <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot; - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">brief</span>
                        <span class="ruby-keyword">end</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">s</span>,<span class="ruby-identifier">u</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">20</span>)
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!cmds&quot;</span>, <span class="ruby-string">&quot;Lists commands&quot;</span>,[])
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!random&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>).<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>])).<span class="ruby-identifier">to_s</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">msg</span>((<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>])<span class="ruby-operator">+</span> <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]) <span class="ruby-operator">-</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]))).<span class="ruby-identifier">to_s</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">10</span>)
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!random&quot;</span>, <span class="ruby-string">&quot;Displays random number&quot;</span>,
                [<span class="ruby-string">&quot;Usage : !random [a[,b]] \n&quot;</span>,
                <span class="ruby-string">&quot;Without args, it displays random number from 0 to 9\n&quot;</span>,
                <span class="ruby-string">&quot;With 1 arg, it displays number from 0 to a\n&quot;</span>,
                <span class="ruby-string">&quot;With 2 args, it displays number from a to b&quot;</span>])
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!bandit&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">num</span> = []
                <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;--&lt;&quot;</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                <span class="ruby-identifier">msg</span>(<span class="ruby-string">&quot;&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;-&lt;&quot;</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                <span class="ruby-identifier">m</span> = <span class="ruby-string">&quot;&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">num</span>.<span class="ruby-identifier">join</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;&lt;&quot;</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>]
                        <span class="ruby-identifier">m</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&quot;win&quot;</span>)
                        <span class="ruby-identifier">b_set</span>(<span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">u</span>)
                <span class="ruby-keyword">else</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>]
                                        <span class="ruby-identifier">m</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&quot;lose&quot;</span>)
                        <span class="ruby-keyword">else</span>
                                <span class="ruby-identifier">m</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot; Второй шанс&quot;</span>
                                <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">m</span>,<span class="ruby-identifier">c</span>)
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>]
                                        <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>]
                                        <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>]
                                        <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>] = <span class="ruby-constant">Random</span>.<span class="ruby-identifier">rand</span>(<span class="ruby-value">10</span>)
                                <span class="ruby-keyword">end</span>
                                <span class="ruby-identifier">m</span> = <span class="ruby-string">&quot;&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">num</span>.<span class="ruby-identifier">join</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;&lt; &quot;</span>
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">num</span>[<span class="ruby-value">2</span>]
                                        <span class="ruby-identifier">m</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&quot;win&quot;</span>)
                                        <span class="ruby-identifier">b_set</span>(<span class="ruby-identifier">num</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">u</span>)
                                <span class="ruby-keyword">else</span>
                                        <span class="ruby-identifier">m</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">getmsg</span>(<span class="ruby-string">&quot;lose&quot;</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">m</span>,<span class="ruby-identifier">c</span>)
                
        },<span class="ruby-value">60</span>)
        
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!bandit&quot;</span>,<span class="ruby-string">&quot;One-arm bandit&quot;</span>,[])
                
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!winners&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">b_show</span>(<span class="ruby-identifier">c</span>)
        },<span class="ruby-value">10</span>)
                
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!winners&quot;</span>, <span class="ruby-string">&quot;Displays !bandit winners&quot;</span>,[])
                
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!motd&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
                        <span class="ruby-identifier">$motd</span> = <span class="ruby-identifier">a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>)
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">$motd</span>,<span class="ruby-identifier">c</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">10</span>)
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!motd&quot;</span>, <span class="ruby-string">&quot;Shows or sets message of the day&quot;</span>,
                [<span class="ruby-string">&quot;Usage : !motd [&lt;motd&gt;]&quot;</span>,
                <span class="ruby-string">&quot;If &lt;motd&gt; is set, then sets motd&quot;</span>,
                <span class="ruby-string">&quot;Else, displays current motd&quot;</span>])
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!help&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}0,5=============[#{$c}5,0HELP#{$c}0,5]=============#{$c}&quot;</span>,<span class="ruby-identifier">u</span>)
                        <span class="ruby-identifier">cmda</span> = {}
                        <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$cmdh</span>.<span class="ruby-identifier">keys</span>
                                <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}0,5#{k+$c} - #{$cmdh[k].brief}&quot;</span>,<span class="ruby-identifier">u</span>)
                        <span class="ruby-keyword">end</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Type #{$c}0,5!help &lt;command&gt;#{$c} for further info&quot;</span>, <span class="ruby-identifier">u</span>)
                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}0,5===============================#{$c}&quot;</span>,<span class="ruby-identifier">u</span>)
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}0,5=============[#{$c}5,0HELP#{$c}0,5]=============#{$c}&quot;</span>,<span class="ruby-identifier">u</span>)
                        <span class="ruby-keyword">for</span> <span class="ruby-identifier">p</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">a</span>
                                <span class="ruby-keyword">if</span> <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">p</span>]
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">p</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">p</span>].<span class="ruby-identifier">brief</span>,<span class="ruby-identifier">u</span>)
                                        <span class="ruby-keyword">for</span> <span class="ruby-identifier">l</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$cmdh</span>[<span class="ruby-identifier">p</span>].<span class="ruby-identifier">text</span>
                                                <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">l</span>,<span class="ruby-identifier">u</span>)
                                        <span class="ruby-keyword">end</span>        
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;Aliases : #{$c}0,5#{aliases(p).join(&quot;,&quot;)+$c}&quot;</span>,<span class="ruby-identifier">u</span>)
                                <span class="ruby-keyword">else</span>
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">p</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;: No help page&quot;</span>,<span class="ruby-identifier">u</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">end</span>
                        <span class="ruby-identifier">msg</span>(<span class="ruby-node">&quot;#{$c}0,5===============================#{$c}&quot;</span>,<span class="ruby-identifier">u</span>)
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">60</span>)
                
        <span class="ruby-identifier">addcmd</span>(<span class="ruby-string">&quot;!perm&quot;</span>, <span class="ruby-value">5</span>, <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{
                <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">u</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> 
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;get&quot;</span>
                                <span class="ruby-identifier">$conn</span>.<span class="ruby-identifier">send_notice</span>(<span class="ruby-identifier">u</span>,<span class="ruby-node">&quot;You have level #{$perms[u].to_s}&quot;</span>)
                        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;show&quot;</span>
                                <span class="ruby-keyword">for</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">$perms</span>.<span class="ruby-identifier">keys</span>()
                                        <span class="ruby-identifier">msg</span>(<span class="ruby-identifier">k</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$perms</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">to_s</span>,<span class="ruby-identifier">u</span>)
                                <span class="ruby-keyword">end</span>
                        <span class="ruby-keyword">end</span>
                        
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;set&quot;</span>
                                <span class="ruby-constant">Permissions</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">u</span>,<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>)
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>
                        <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;set&quot;</span>
                                <span class="ruby-constant">Permissions</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>],<span class="ruby-identifier">a</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>)
                        <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">end</span>
        },<span class="ruby-value">5</span>)
        <span class="ruby-identifier">addhelp</span>(<span class="ruby-string">&quot;!perm&quot;</span>,<span class="ruby-string">&quot;Permissions control&quot;</span>,
                [
                        <span class="ruby-string">&quot;Usage : !perm(set [[&lt;nick&gt; ]&lt;level&gt;]|get|show)&quot;</span>,
                        <span class="ruby-string">&quot;!perm set &lt;level&gt; - sets you lvl &lt;level&gt;&quot;</span>,
                        <span class="ruby-string">&quot;!perm set &lt;nick&gt; &lt;level&gt; - sets user &lt;nick&gt; level &lt;level&gt;&quot;</span>,
                        <span class="ruby-string">&quot;!perm get - shows your level, !perm show - shows levels&quot;</span>
                ])
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!бот13&quot;</span>, <span class="ruby-string">&quot;!bot13&quot;</span>)
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!рандом&quot;</span>, <span class="ruby-string">&quot;!random&quot;</span>)
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!бандит&quot;</span>, <span class="ruby-string">&quot;!bandit&quot;</span>)
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!бандиты&quot;</span>, <span class="ruby-string">&quot;!winners&quot;</span>)
        <span class="ruby-identifier">addalias</span>(<span class="ruby-string">&quot;!хелп&quot;</span>, <span class="ruby-string">&quot;!help&quot;</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/&quot;</span>)
                <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/&quot;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/bandit.cfg&quot;</span>)
                <span class="ruby-identifier">b_save</span>()
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/perms.cfg&quot;</span>)
                <span class="ruby-constant">Permissions</span>.<span class="ruby-identifier">save</span>()
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">b_load</span>()
        <span class="ruby-constant">Permissions</span>.<span class="ruby-identifier">load</span>()
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/plugins/&quot;</span>)
                <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">$home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/.bot13/plugins&quot;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-comment">#papiinit      </span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

